<!DOCTYPE html>
<html>
<head>
  <title>Capture and Upload Image</title>
  <style>
    video, canvas {
      max-width: 100%;
      border: 2px solid #ccc;
      margin: 10px 0;
    }
    button {
      padding: 10px 20px;
      margin: 10px;
    }
  </style>
</head>
<body>
  <h2>Capture Image and Upload to Google Drive</h2>
  <video id="video" autoplay playsinline width="320" height="240"></video><br>
  <button id="capture">Capture</button>
  <canvas id="canvas" width="320" height="240" style="display:none;"></canvas><br>
  <button id="upload" disabled>Upload to Drive</button>
  <p id="status"></p>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const captureBtn = document.getElementById('capture');
    const uploadBtn = document.getElementById('upload');
    const status = document.getElementById('status');

    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => video.srcObject = stream)
      .catch(err => alert('Camera access denied: ' + err));

    captureBtn.onclick = () => {
      const context = canvas.getContext('2d');
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      uploadBtn.disabled = false;
      status.textContent = 'Image captured. Ready to upload.';
    };

    uploadBtn.onclick = async () => {
      const imageData = canvas.toDataURL('image/jpeg');
      status.textContent = 'Uploading...';

      const response = await fetch('https://script.google.com/macros/s/AKfycbxhvnbT195Op_uNmNnU2cAa9RcdztNHXd1DQxXQZFrGHhzKMs007w2gdRfm3qRdoy5W/exec', {
        method: 'POST',
        body: JSON.stringify({ image: imageData }),
        headers: { 'Content-Type': 'application/json' }
      });

      const result = await response.text();
      status.textContent = result;
    };
  </script>
</body>
</html>
